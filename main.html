<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì ê²½ë ¥í™•ì¸ì„œ (ìµœì¢… ì™„ì„±)</title>
<style>
    /* --- [1. ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ì„¤ì •] --- */
    :root {
        --base-width: 210mm; 
        --base-height: 297mm; 
        --content-bg: #555;
        --nav-height-pc: 70px;
        --nav-height-mobile: 50px;
    }

    body { 
        background-color: var(--content-bg); 
        margin: 0; padding: 0; 
        font-family: 'Malgun Gothic', 'Dotum', sans-serif; 
        overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
        width: 100vw; height: 100vh;
        display: flex; flex-direction: column; align-items: center;
        padding-top: var(--nav-height-pc); 
    }

    /* --- [2. ìƒë‹¨ ê³ ì • ë‚´ë¹„ê²Œì´ì…˜ ë°”] --- */
    .top-nav {
        position: fixed; top: 0; left: 0; width: 100%; height: var(--nav-height-pc); z-index: 9999;
        display: flex; align-items: center; justify-content: center; gap: 15px;
        background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .nav-btn {
        padding: 8px 16px; font-size: 14px; font-weight: bold; color: white;
        border: 1px solid rgba(255, 255, 255, 0.4); border-radius: 8px; cursor: pointer;
        display: flex; align-items: center; justify-content: center; gap: 5px; white-space: nowrap;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: transform 0.1s;
    }
    .nav-btn:active { transform: scale(0.95); }

    .btn-orange { background: rgba(255, 140, 0, 0.7); }
    .btn-blue   { background: rgba(41, 128, 185, 0.6); }
    .btn-green  { background: rgba(39, 174, 96, 0.6); }
    .btn-pink   { background: rgba(255, 105, 180, 0.6); }
    .btn-red    { background: rgba(192, 57, 43, 0.6); }

    /* --- [3. ê³„ì‚°ê¸° íŒ¨ë„] --- */
    .calc-panel {
        position: fixed; top: 80px; left: 50%; transform: translateX(-50%); z-index: 9998;
        display: none; flex-direction: column; gap: 10px; padding: 15px 20px; width: 200px;
        background: rgba(255, 140, 0, 0.95); border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 16px; backdrop-filter: blur(10px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3); color: white;
    }
    .calc-panel.show { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateX(-50%) translateY(-10px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }

    .calc-toggle { position: absolute; right: -25px; top: 10px; width: 25px; height: 30px; background: rgba(255, 140, 0, 0.8); border-radius: 0 8px 8px 0; cursor: pointer; display: none; align-items: center; justify-content: center; font-size: 12px; color: white; }
    .calc-header { font-weight: bold; font-size: 11pt; border-bottom: 1px solid rgba(255,255,255,0.5); padding-bottom: 8px; margin-bottom: 5px; text-align: center; }
    .calc-row { display: flex; justify-content: space-between; align-items: center; }
    .calc-label { font-size: 10pt; } .calc-value { font-weight: bold; font-size: 16pt; } .calc-unit { font-size: 10pt; margin-left: 2px; }

    /* --- [4. ë°˜ì‘í˜• ë˜í¼] --- */
    #responsive-wrapper {
        width: var(--base-width); height: var(--base-height);
        transform-origin: top center; transition: transform 0.2s ease;
        margin-top: 10px; background-color: white; box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }
    .page-container {
        background-color: white; width: 100%; height: 100%; padding: 10mm 15mm;
        box-sizing: border-box; position: relative; display: flex; flex-direction: column;
    }

    /* --- [5. í…Œì´ë¸” ë° ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼] --- */
    table { width: 100%; border-collapse: collapse; margin: 0; table-layout: fixed; }
    th, td { border: 1px solid #000; padding: 1px 3px; vertical-align: middle; word-break: keep-all; font-size: 8.5pt; height: 24px; color: #000; }
    .no-side-outer tr th:first-child, .no-side-outer tr td:first-child { border-left: none !important; }
    .no-side-outer tr th:last-child, .no-side-outer tr td:last-child { border-right: none !important; }
    th { background-color: #e6e6e6; text-align: center; font-weight: normal; letter-spacing: -0.5px; }
    .border-top-thick { border-top: 2px solid #000 !important; }
    .border-bottom-thick { border-bottom: 2px solid #000 !important; }
    
    input, textarea, select {
        width: 100%; height: 100%; border: none; padding: 0; margin: 0;
        font-family: inherit; font-size: 8.5pt;
        background-color: transparent; outline: none; box-sizing: border-box;
        vertical-align: middle; color: #000; -webkit-appearance: none; border-radius: 0;
    }
    select {
        padding-right: 15px; 
        background: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10'%3E%3Cpath d='M0 0 L5 5 L10 0' fill='none' stroke='%23000' stroke-width='1.5'/%3E%3C/svg%3E") no-repeat right 2px center;
        background-size: 8px;
    }
    input:focus, textarea:focus, select:focus { background-color: #e8f0fe; }
    input:disabled, select:disabled { background-color: #f0f0f0; color: #aaa; cursor: not-allowed; }
    
    /* í•„ìˆ˜ê°’ ë¯¸ì…ë ¥ ì‹œ ë¹¨ê°„ í…Œë‘ë¦¬ */
    .required-missing { border: 2px solid #ff3333 !important; background-color: rgba(255, 51, 51, 0.05) !important; border-radius: 3px; }
    
    .center-text { text-align: center; }
    .left-text { text-align: left !important; padding-left: 5px; }
    .long-label { font-size: 7pt; letter-spacing: -0.8px; line-height: 1.1; }
    .nowrap-text { white-space: nowrap; }

    /* â˜…â˜…â˜… [ë‚ ì§œ ì…ë ¥ í•„ë“œ ë””ìì¸ í•µì‹¬] â˜…â˜…â˜… */
    /* ê¸°ë³¸ ìƒíƒœ: ê¸€ì íˆ¬ëª…, ë‹ë³´ê¸° í‘œì‹œ */
    input[type="date"] { 
        position: relative; text-align: center; color: transparent; padding: 0; cursor: pointer;
    }
    /* í¬ë¡¬/ì—£ì§€ìš© ì‹¤ì œ í…ìŠ¤íŠ¸ ìˆ¨ê¹€ ì²˜ë¦¬ */
    input[type="date"]::-webkit-datetime-edit { color: transparent; }
    
    /* í¬ì»¤ìŠ¤ ë˜ê±°ë‚˜ ìœ íš¨í•œ ê°’(required ì¶©ì¡±)ì´ ìˆì„ ë•Œë§Œ ê¸€ì ë³´ì´ê¸° */
    input[type="date"]:focus, 
    input[type="date"]:valid { 
        color: #000; 
    }
    input[type="date"]:focus::-webkit-datetime-edit, 
    input[type="date"]:valid::-webkit-datetime-edit { 
        color: #000; 
    }

    /* ë‹ë³´ê¸° ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
    input[type="date"]::-webkit-calendar-picker-indicator { 
        position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; cursor: pointer; 
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555555'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E");
        background-position: center; background-repeat: no-repeat; background-size: contain; width: 14px; height: 14px; opacity: 0.7; margin-left: 2px;
    }
    /* ê°’ì´ ì„ íƒë˜ë©´(valid) ë‹ë³´ê¸° ìˆ¨ê¹€ -> ë‚ ì§œë§Œ ë³´ì´ê²Œ */
    input[type="date"]:valid::-webkit-calendar-picker-indicator { background-image: none !important; opacity: 0; }

    /* íˆ´íŒ */
    .custom-tooltip {
        position: absolute; z-index: 1000; pointer-events: none; opacity: 0; transition: opacity 0.3s ease;
        padding: 8px 12px; border-radius: 8px; font-size: 8pt; white-space: nowrap; font-weight: bold;
        background-color: #222; color: white; border: 2px solid transparent;
        background-image: linear-gradient(#222, #222), linear-gradient(135deg, #ff00cc, #3333ff, #00ccff);
        background-origin: border-box; background-clip: padding-box, border-box;
        box-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
    }
    .custom-tooltip.show { opacity: 1; }
    .tooltip-container { position: relative; }

    .footer-wrapper { margin-top: auto; display: flex; flex-direction: column; justify-content: flex-end; }
    
    /* â˜…â˜…â˜… [ì¬ì§ ì²´í¬ë°•ìŠ¤ ì»¤ìŠ¤í…€] â˜…â˜…â˜… */
    .working-check-label {
        display: inline-flex; align-items: center; cursor: pointer; margin-left: 5px; font-size: 9pt;
    }
    /* ì‹¤ì œ ì²´í¬ë°•ìŠ¤ ìˆ¨ê¸°ê³  ì»¤ìŠ¤í…€ ë°•ìŠ¤ ìƒì„± */
    .working-check-label input {
        appearance: none; -webkit-appearance: none;
        width: 14px; height: 14px;
        background-color: #fff;
        border: 1px solid #000; /* ê²€ì€ í…Œë‘ë¦¬ */
        margin-right: 4px;
        position: relative;
        cursor: pointer;
        border-radius: 0;
    }
    /* ì²´í¬ ì‹œ 'âœ”' í‘œì‹œ */
    .working-check-label input:checked::after {
        content: 'âœ”';
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        font-size: 12px;
        color: black;
        font-weight: bold;
        line-height: 1;
    }

    /* --- [6. ë¯¸ë””ì–´ ì¿¼ë¦¬ (ëª¨ë°”ì¼ í™”ë©´ ìµœì í™”)] --- */
    @media screen and (max-width: 768px) {
        body { padding-top: var(--nav-height-mobile); justify-content: flex-start; }
        
        .top-nav { 
            height: var(--nav-height-mobile); padding: 0 2px; gap: 2px;
            display: grid; grid-template-columns: repeat(5, 1fr); 
        }
        
        .nav-btn { 
            padding: 2px 0; font-size: 9.5px; letter-spacing: -0.5px; word-break: keep-all;
            width: 100%; height: 40px; border-radius: 6px; flex-direction: column; gap: 1px;
        }

        .calc-panel { top: 55px; width: 90%; }
        .calc-toggle { display: flex; }
        #responsive-wrapper { margin-top: 5px; }
    }

    /* --- [7. ì¸ì‡„ ëª¨ë“œ ì„¤ì •] --- */
    @media print {
        /* â˜…â˜…â˜… ë¸Œë¼ìš°ì € ì¶œë ¥ ë¬¸êµ¬(ë‚ ì§œ, URL ë“±) ì œê±° â˜…â˜…â˜… */
        @page { size: A4; margin: 0; }
        
        body { background: white; padding: 0; margin: 0; height: 100%; overflow: visible; display: block; }
        .top-nav, .calc-panel, .custom-tooltip { display: none !important; }
        
        #responsive-wrapper { 
            transform: none !important; width: 100% !important; height: auto !important; margin: 0 !important; box-shadow: none !important; 
        }
        .page-container { 
            border: none; width: 100%; height: 297mm; 
            /* ì—¬ë°±ì„ íŒ¨ë”©ìœ¼ë¡œ í™•ë³´ */
            padding: 10mm 15mm; 
        }
        
        .footer-wrapper { margin-top: auto !important; }
        input, textarea, select { background: transparent !important; }
        
        .empty-value { color: transparent !important; } 
        select { background-image: none; padding-right: 0; }
        
        /* ë‚ ì§œ í•„ë“œ ì¸ì‡„ ì‹œ ë‹ë³´ê¸° ìˆ¨ê¹€ */
        input[type="date"] { color: transparent; } 
        input[type="date"]:valid { color: #000; }
        input[type="date"]::-webkit-calendar-picker-indicator { display: none !important; }
        
        .required-missing { border: none !important; background-color: transparent !important; }
        
        /* ì¸ì‡„ ì‹œ ì¬ì§ ë²„íŠ¼/ì•ˆë‚´ë¬¸êµ¬ ìˆ¨ê¹€ */
        .working-check-label { display: none !important; }
        ::placeholder { color: transparent !important; }
    }
</style>
</head>
<body onload="initAllFields(); resizeForm();" onresize="resizeForm()">

<input type="file" id="file_input" style="display:none" accept=".json" onchange="loadFromFile(this)">

<nav class="top-nav">
    <button class="nav-btn btn-orange" onclick="toggleCalcPanel()">ğŸ“… ì°¸ì—¬ê¸°ê°„ ê³„ì‚°ê¸°</button>
    <button class="nav-btn btn-blue" onclick="saveToFile()">ğŸ’¾ ì €ì¥</button>
    <button class="nav-btn btn-green" onclick="triggerFileLoad()">ğŸ“‚ ì—´ê¸°</button>
    <button class="nav-btn btn-pink" onclick="validateAndPrint()">ğŸ–¨ï¸ ì¸ì‡„</button>
    <button class="nav-btn btn-red" onclick="if(confirm('ë‚´ìš©ì„ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) location.reload();">ğŸ”„ ì´ˆê¸°í™”</button>
</nav>

<div class="calc-panel" id="calcPanel">
    <div class="calc-toggle" onclick="document.getElementById('calcPanel').classList.toggle('collapsed')">â—€</div>
    <div class="calc-header">ğŸ“… ì°¸ì—¬ê¸°ê°„ ìë™ ê³„ì‚°</div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 1</span>
        <div><span id="panel_days_1" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 2</span>
        <div><span id="panel_days_2" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
</div>

<div id="responsive-wrapper">
    <div class="page-container">
        <div style="font-size: 8pt; margin-bottom: 15px; font-weight:bold;">
            â–  ê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ [ë³„ì§€ ì œ12í˜¸ì„œì‹] &lt;ê°œì • 2024. 4. 23.&gt;
        </div>

        <div style="position: relative; height: 60px; margin-bottom: 20px;">
            <h1 style="position: absolute; width: 100%; top: 60%; transform: translateY(-50%); text-align: center; font-size: 20pt; letter-spacing: 5px; margin: 0; padding-right: 150px; box-sizing: border-box;">
                ê²½ë ¥í™•ì¸ì„œ
            </h1>
            <table style="width: 180px; position: absolute; top: -20px; right: 0; border: 2px solid black; height: 40px;">
                <colgroup><col style="width: 40%"><col style="width: 40%"><col style="width: 40%"></colgroup>
                <tr>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">êµ¬ë¶„</th>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì¸ì‚¬ë¶€ì„œ</th>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì‚¬ì—…ë¶€ì„œ</th>
                </tr>
                <tr>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë¶€ì„œëª…</th>
                    <td style="height:7px;"></td> <td style="height:7px;"></td>
                </tr>
                <tr>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë‹´ë‹¹ì</th>
                    <td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td>
                    <td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td>
                </tr>
                <tr>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì—°ë½ì²˜</th>
                    <td style="height:7px;"></td> <td style="height:7px;"></td>
                </tr>
                <tr>
                    <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë°œê¸‰ë²ˆí˜¸</th>
                    <td colspan="2" style="height:7px;"></td>
                </tr>
            </table>
        </div>

        <table class="border-top-thick no-side-outer" style="margin-bottom: 10px;">
            <colgroup>
                <col style="width: 10%;"> <col style="width: 10%;"> <col style="width: 20%;"> 
                <col style="width: 12%;"> <col style="width: 18%;"> <col style="width: 13%;"> <col style="width: 17%;">
            </colgroup>
            <tr>
                <th rowspan="2">ì¸ì <br>ì‚¬í•­</th>
                <th>â‘  ì„± ëª…</th>
                <td>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <input type="text" id="user_name" style="width:60%;">
                        <span class="nowrap-text" style="font-size:7pt; color:#888;">(ì„œëª… ë˜ëŠ” ì¸)</span>
                    </div>
                </td>
                <th>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th>
                <td><input type="text" id="user_id" class="center-text" oninput="formatNumber(this, 'id')"></td>
                <th class="long-label">íœ´ëŒ€ì „í™”ë²ˆí˜¸<br>(ì „í™”ë²ˆí˜¸)</th>
                <td><input type="tel" id="user_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td>
            </tr>
            <tr>
                <th>â‘¡ ì£¼ ì†Œ</th>
                <td colspan="3"><input type="text" id="user_addr" oninput="autoFitText(this)"></td>
                <th>ì „ììš°í¸ì£¼ì†Œ</th>
                <td><input type="email" id="user_email"></td>
            </tr>
        </table>
        
        <table class="no-side-outer">
            <colgroup>
                <col style="width: 10%;"> <col style="width: 10%;"> <col style="width: 20%;"> 
                <col style="width: 12%;"> <col style="width: 18%;"> <col style="width: 13%;"> <col style="width: 17%;">
            </colgroup>
            <tr class="border-top-thick">
                <th rowspan="3">ì†Œì†<br>íšŒì‚¬</th>
                <th colspan="2">â‘¢ íšŒì‚¬ëª… ë° ëŒ€í‘œì</th>
                <td colspan="2"><input type="text" id="comp_name" oninput="autoFitText(this)"></td>
                <th class="long-label" style="font-size:7pt;">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸<br>(ë²•ì¸ë“±ë¡ë²ˆí˜¸)</th>
                <td><input type="text" id="comp_biz" class="center-text" oninput="formatNumber(this, 'biz')"></td>
            </tr>
            <tr>
                <th colspan="2">ì˜ì—…ì†Œ ì†Œì¬ì§€</th>
                <td colspan="2"><input type="text" id="comp_addr" oninput="autoFitText(this)"></td>
                <th class="long-label">â‘£ ê±´ì„¤ì—…ì¢…<br>(ë“±ë¡ë²ˆí˜¸)</th>
                <td><input type="text" id="comp_sector"></td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border-right:1px solid #000;">
                    <div style="display:flex; height:100%; width:100%;">
                        <div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¤ ì…ì‚¬ì¼</div>
                        <div style="flex:1; border-right:1px solid #000; padding:0 2px;"><input type="date" id="join_date" required onchange="validateAllDates(1); validateAllDates(2);" onkeydown="return false;"></div>
                        <div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¥ í‡´ì‚¬ì¼</div>
                        <div style="flex:1; padding:0 2px; display:flex; align-items:center; justify-content:center;">
                            <input type="date" id="retire_date" required style="width: 100%;" onchange="validateAllDates(1); validateAllDates(2);" onkeydown="return false;">
                            <div id="retire_text" style="display:none; width:100%; text-align:center; font-size:8.5pt;">ì¬ì§ì¤‘</div>
                            <label class="working-check-label" title="í˜„ì¬ ê·¼ë¬´ ì¤‘ì´ë©´ ì²´í¬í•˜ì„¸ìš”">
                                <input type="checkbox" id="chk_working" onchange="toggleRetireDate()">ì¬ì§
                            </label>
                        </div>
                    </div>
                </td>
                <th>ì „í™”ë²ˆí˜¸</th>
                <td><input type="tel" id="comp_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td>
            </tr>
        </table>

        <div style="text-align:center; font-weight:bold; background:#eaeaea; border:1px solid #000; border-bottom:none; border-left:none; border-right:none; margin-top:5px; height:24px; line-height:24px; font-size:9pt;" class="border-top-thick">
            ê¸° ìˆ  ê²½ ë ¥
        </div>

        <table class="border-bottom-thick no-side-outer">
            <colgroup>
                <col style="width: 4%;"> <col style="width: 24%;"> <col style="width: 24%;"> <col style="width: 24%;"> <col style="width: 24%;">
            </colgroup>
            <tr>
                <th rowspan="5" class="border-bottom-thick">ì—°<br>ë²ˆ</th>
                <th class="left-text">â‘¦ ì‚¬ì—…ê¸°ê°„(ì°©ê³µ~ì¤€ê³µ)</th>
                <th colspan="3" class="left-text">â‘¨ ì°¸ì—¬ì‚¬ì—…ëª…</th>
            </tr>
            <tr>
                <th class="left-text">â‘§ ì°¸ì—¬ê¸°ê°„(ì‹œì‘~ì¢…ë£Œ)</th>
                <th colspan="3" class="left-text">â‘© ë°œì£¼ì(ì²­)</th>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <th class="left-text" style="border-left:none; border-top:none;">â‘ª ê³µì‚¬ì¢…ë¥˜</th>
                            <th class="left-text" style="border-top:none;">â‘« ê³µì‚¬(ìš©ì—­)ê¸ˆì•¡(ë°±ë§Œì›)</th>
                            <th class="left-text" style="border-top:none;">â‘¬ ì§ë¬´ë¶„ì•¼</th>
                            <th class="left-text" style="border-top:none; border-right:none;">â‘­ ì „ë¬¸ë¶„ì•¼</th>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;"style="width:100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #ccc;">        
                        <colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <th class="left-text" style="border-left:none; border-top:none;">â‘® ê³µì‚¬(ìš©ì—­)ê°œìš”(150ì ì´ë‚´ ë¹ˆì¹¸ í¬í•¨)</th>
                            <th class="left-text" style="border-top:none;">â‘¯ ë‹´ë‹¹ì—…ë¬´</th>
                            <th class="left-text" style="border-top:none; font-size: 6.5pt; letter-spacing: -0.5px; padding: 0; line-height: 24px; text-align:center; white-space:nowrap;">â‘° ì±…ì„ì •ë„</th>
                            <th class="left-text" style="border-top:none; border-right:none;">â‘± ì§ìœ„</th>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <th class="left-text" style="border-left:none; border-top:none; border-bottom:1px solid black;">â‘² ì ìš© ê³µë²•</th>
                            <th class="left-text" style="border-top:none; border-bottom:1px solid black;">â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ </th>
                            <th class="left-text" style="border-top:none; border-bottom:1px solid black;">ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±</th>
                            <th class="left-text" style="border-top:none; border-bottom:1px solid black; border-right:none;">ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜</th>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr>
                <th rowspan="5" class="border-bottom-thick" style="background:#fff;">1</th>
                <td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td>
                <td colspan="3" class="tooltip-container">
                    <input type="text" id="proj_name_1" class="left-text e1-req" placeholder="â€» í´ë¦­í•˜ì—¬ ì˜ˆì‹œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”!" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkEntry1(); checkHeadquarters(1)">
                    <div class="custom-tooltip" id="tooltip_proj_name_1">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div>
                </td>
            </tr>
            <tr>
                <td><div style="display:flex;">
                    <input type="date" id="part_start_1" required class="e1-req" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(1)" oninput="checkEntry1()">~
                    <input type="date" id="part_end_1" required class="e1-req" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(1)" oninput="checkEntry1()">
                </div></td>
                <td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;"><input type="text" class="left-text" id="amt_1" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; text-align: center;">ê¸°ê³„</td>
                            <td style="border-top:none; border-right:none; padding-left: 0;">
                                <select id="spec1" class="left-text e1-req" onchange="checkSelectPlaceholder(this); checkEntry1();">
                                    <option value="">ì„ íƒ</option>
                                </select>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;">
                                <select id="task1" class="left-text e1-req" style="font-size: 8pt;" onchange="updateResponsibility(1); checkEntry1(); checkSelectPlaceholder(this);">
                                    <option value="">ì„ íƒ</option>
                                </select>
                            </td>
                            <td style="border-top:none; padding-right: 0;"><input type="text" id="resp1" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_1" class="left-text e1-req" oninput="checkEntry1()"></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-bottom:2px solid black; border-right:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="entry2-row">
                <th rowspan="5" style="background:#fff;">2</th>
                <td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td>
                
                <td colspan="3" class="tooltip-container e2-all">
                    <input type="text" id="proj_name_2" class="left-text e2-req e2-all" placeholder="â€» í´ë¦­í•˜ì—¬ ì˜ˆì‹œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”!" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkHeadquarters(2); checkEntry2();" disabled>
                    <div class="custom-tooltip e2-all" id="tooltip_proj_name_2" style="display: none;">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div>
                </td>
            </tr>
            <tr class="entry2-row">
                <td><div style="display:flex;">
                    <input type="date" id="part_start_2" required class="e2-req e2-all" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(2); checkEntry2();" disabled>~
                    <input type="date" id="part_end_2" required class="e2-req e2-all" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(2); checkEntry2();" disabled>
                </div></td>
                <td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td>
            </tr>
            <tr class="entry2-row">
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; text-align: center;">ê¸°ê³„</td>
                            <td style="border-top:none; border-right:none; padding-left: 0;">
                                <select id="spec2" class="left-text e2-req e2-all" onchange="checkSelectPlaceholder(this); checkEntry1(); checkEntry2();" disabled>
                                    <option value="">ì§ë¬´ë¶„ì•¼ ì„ íƒ í•„ìš”</option>
                                </select>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="entry2-row">
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;">
                                <select id="task2" class="left-text e2-req e2-all" style="font-size: 8pt;" onchange="updateResponsibility(2); checkSelectPlaceholder(this); checkEntry2();" disabled>
                                    <option value="">ì„ íƒ</option>
                                </select>
                            </td>
                            <td style="border-top:none; padding-right: 0;"><input type="text" id="resp2" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_2" class="left-text e2-req e2-all" oninput="checkEntry2()" disabled></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="entry2-row">
                <td colspan="4" style="padding:0; border:none;">
                    <table style="width:100%; border:none;">
                        <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                        <tr>
                            <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                            <td style="border-top:none; border-right:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <div class="footer-wrapper">
            <div style="margin-top: 10px; display:flex; justify-content:space-between; align-items:flex-end;">
                <span style="font-size: 10pt; margin-left:5px;">ìœ„ì™€ ê°™ì´ ê±´ì„¤ê¸°ìˆ ì¸ì˜ ê²½ë ¥ì„ í™•ì¸í•©ë‹ˆë‹¤.</span>
                <span style="font-size: 10pt; margin-right:5px;">
                    <input type="tel" style="width:40px; text-align:right;" placeholder="202X">ë…„
                    <input type="tel" style="width:30px; text-align:right;" placeholder="00">ì›”
                    <input type="tel" style="width:30px; text-align:right;" placeholder="00">ì¼
                </span>
            </div>
            
            <div style="position:relative; width:100%; height:50px; text-align:center; margin-top:20px;">
                <span style="font-size: 16pt; font-weight: bold; letter-spacing: -1px;">
                    ë°œì£¼ì, ì¸ã†í—ˆê°€ê¸°ê´€ ë˜ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì)
                </span>
                <div style="position:absolute; right:80px; top:-10px; width:50px; height:50px; display:flex; align-items:center; justify-content:center; color:red; font-weight:bold; border:2px solid red; font-size:10pt;">
                    ì§ì¸
                </div>
            </div>

            <div style="margin-top: 5px;">        
                <table style="border: 1px solid #000; border-top: 2px solid #000; width:100%; border-bottom: none;">
                    <tr>
                        <th style="background-color:#ccc; height:20px; border-bottom:3px solid #000; font-size:9pt; border-left:none; border-right:none;">ìœ ì˜ì‚¬í•­</th>
                    </tr>
                    <tr>
                        <td style="padding:10px 10px; font-size:8pt; line-height:1.6; border:none; vertical-align:top; letter-spacing:-0.5px;">
                            1. ê¸°ìˆ ê²½ë ¥ì„ ì„¤ê³„ ë˜ëŠ” ê±´ì„¤ì‚¬ì—…ê´€ë¦¬ ì‚¬ì—…ìˆ˜í–‰ëŠ¥ë ¥í‰ê°€ì— í™œìš©í•˜ë ¤ëŠ” ê²½ìš° ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•˜ë©°, ì…ì‚¬ì‹ ê³  ë˜ëŠ” ì¼ë°˜ì ì¸ ê²½ë ¥ì‹ ê³ ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì) ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>
                            2. â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ ë€, ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±ë€ ë° ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜ë€ì€ ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ì˜ í™•ì¸ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¸ì •ë©ë‹ˆë‹¤.<br>
                            3. ê±´ì„¤ê¸°ìˆ ì¸ ë³¸ì¸ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ê±´ì„¤ê¸°ìˆ ì¸ ê²½ë ¥ë³€ê²½ì‹ ê³ ì„œ(ã€Œê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ã€ ë³„ì§€ ì œ14í˜¸ì„œì‹ì„ ë§í•©ë‹ˆë‹¤)ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë˜ë©°, ì…ã†í‡´ì‚¬ì¼ì„ ì‹ ê³ í•˜ëŠ” ê²½ìš° 4ëŒ€ ë³´í—˜ ìë£Œ ë“± ì¦ëª…í•  ìˆ˜ ìˆëŠ” ì„œë¥˜ë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>
                            4. ë‹¤ìˆ˜ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ê¸°ìˆ ê²½ë ¥ë§Œì„ ì ì€ ì„œë¥˜ë¥¼ ì²¨ë¶€í•˜ì—¬ ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 2ì¥ ì´ìƒì€ ê° ì¥ì— ì‚¬ìš©ì(ëŒ€í‘œì) ë˜ëŠ” ë°œì£¼ìì˜ í™•ì¸(ê°„ì¸ í¬í•¨)ì„ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.<br>
                            5. ì‹ ê³ ì¸(ë³¸ì¸)ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì€ ë³¸ì¸ì´ ì§ì ‘ í•´ì•¼ í•˜ë©° íƒ€ì¸ì´ ì´ë¥¼ ìœ„ì¡°í•˜ëŠ” ê²½ìš° ã€Œí˜•ë²•ã€ ì œ239ì¡°ì— ë”°ë¼ ì²˜ë²Œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                </table>
                
                <table style="border: 1px solid #000; border-top: 1px solid #000; border-bottom:2px solid #000; margin-top:-1px;">
                    <colgroup>
                        <col style="width: 10%;"> <col style="width: 12%;"> <col style="width: 25%;"> 
                        <col style="width: 13%;"> <col style="width: 40%;">
                    </colgroup>
                    <tr>
                        <th style="background:#fff; height:24px; border-left:none;">ëŒ€ë¦¬ì¸</th>
                        <th style="background:#fff;">ì„±ëª…</th>
                        <td style="position:relative;">
                            <input type="text" class="center-text">
                            <span style="position:absolute; right:5px; top:5px; color:#aaa; font-size:6pt;">(ì„œëª… ë˜ëŠ” ì¸)</span>
                        </td>
                        <th style="background:#fff;">ìƒë…„ì›”ì¼</th>
                        <td style="border-right:none; padding:0;">
                            <div style="display:flex; height:100%;">
                                <input type="tel" style="width:60%; text-align:center;">
                                <span style="border-left:1px solid #000; border-right:1px solid #000; width:100px; background:#fff; display:flex; align-items:center; justify-content:center; font-size:8pt;">ì—°ë½ì²˜</span>
                                <input type="tel" style="flex-grow:1; text-align:center;">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        </div>
</div>

<script>
    /* 1. ë°˜ì‘í˜• ìŠ¤ì¼€ì¼ë§ ìŠ¤í¬ë¦½íŠ¸ */
    function resizeForm() {
        const wrapper = document.getElementById('responsive-wrapper');
        const containerWidth = 210 * 3.78; 
        const containerHeight = 297 * 3.78; 
        
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;
        const navHeight = 50; 
        const padding = 10; 

        const availableHeight = screenHeight - navHeight - 10; 
        const scaleX = (screenWidth - padding * 2) / containerWidth;
        const scaleY = availableHeight / containerHeight;

        let scale = scaleX;
        
        if (screenWidth <= 768) { 
             scale = Math.min(scaleX, scaleY);
             wrapper.style.marginBottom = "0px";
        } else {
             if (screenWidth < containerWidth + (padding * 2)) {
                 scale = scaleX;
                 wrapper.style.marginBottom = `-${(1 - scale) * 100}%`;
             } else {
                 scale = 1;
                 wrapper.style.marginBottom = '50px';
             }
        }
        wrapper.style.transform = `scale(${scale})`;
    }

    window.addEventListener("orientationchange", function() { setTimeout(resizeForm, 200); });

    /* 2. ê³„ì‚°ê¸° í† ê¸€ */
    function toggleCalcPanel() {
        const panel = document.getElementById('calcPanel');
        if (panel.style.display === 'flex') { panel.style.display = 'none'; } 
        else { panel.style.display = 'flex'; panel.classList.add('show'); }
    }

    /* 3. ìê°„ ì¡°ì ˆ */
    function autoFitText(el) {
        el.style.letterSpacing = 'normal';
        let hiddenSpan = document.getElementById('text-measure-span');
        if (!hiddenSpan) {
            hiddenSpan = document.createElement('span'); hiddenSpan.id = 'text-measure-span';
            hiddenSpan.style.visibility = 'hidden'; hiddenSpan.style.position = 'absolute'; hiddenSpan.style.whiteSpace = 'nowrap';
            document.body.appendChild(hiddenSpan);
        }
        const computed = window.getComputedStyle(el);
        hiddenSpan.style.font = computed.font; hiddenSpan.style.fontSize = computed.fontSize;
        hiddenSpan.style.fontFamily = computed.fontFamily; hiddenSpan.style.fontWeight = computed.fontWeight;
        hiddenSpan.innerText = el.value;

        const textWidth = hiddenSpan.getBoundingClientRect().width;
        const availableWidth = el.clientWidth; 

        if (textWidth > availableWidth) {
            const length = el.value.length;
            if (length > 1) {
                const overflow = textWidth - availableWidth;
                let spacing = -1 * (overflow / (length - 1)) - 0.5; 
                if (spacing < -3) spacing = -3; 
                el.style.letterSpacing = spacing + 'px';
            }
        } else { el.style.letterSpacing = 'normal'; }
    }

    /* 4. ì €ì¥ */
    async function saveToFile() {
        const data = {};
        document.querySelectorAll('input, select').forEach(el => {
            if (el.id) {
                if(el.type === 'checkbox') data[el.id] = el.checked; else data[el.id] = el.value;
            }
        });
        const jsonStr = JSON.stringify(data, null, 2);
        const fileName = 'ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì_ê²½ë ¥í™•ì¸ì„œ_ë°ì´í„°.json';

        if (window.showSaveFilePicker) {
            try {
                const handle = await window.showSaveFilePicker({
                    suggestedName: fileName,
                    types: [{ description: 'JSON Files', accept: { 'application/json': ['.json'] } }],
                });
                const writable = await handle.createWritable(); await writable.write(jsonStr); await writable.close();
                alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.'); return;
            } catch (err) { if (err.name === 'AbortError') return; console.error(err); }
        }
        const blob = new Blob([jsonStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = fileName;
        document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
    }

    function triggerFileLoad() { document.getElementById('file_input').click(); }

    /* 5. ë¶ˆëŸ¬ì˜¤ê¸° */
    function loadFromFile(input) {
        const file = input.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                for (const [id, val] of Object.entries(data)) {
                    const el = document.getElementById(id);
                    if(el) {
                        if(el.type === 'checkbox') el.checked = val;
                        else { el.value = val; if(id === 'user_addr' || id === 'comp_name' || id === 'comp_addr') autoFitText(el); }
                        if(el.tagName === 'SELECT') checkSelectPlaceholder(el);
                    }
                }
                if(document.getElementById('chk_working').checked) toggleRetireDate();
                updateSpecialty(1); updateSpecialty(2);
                const status = checkEntry1();
                if(status.allFilled) {
                    if(data['task1']) updateResponsibility(1); if(data['task2']) updateResponsibility(2);
                    if(data['spec1']) document.getElementById('spec1').value = data['spec1'];
                    if(data['resp1']) document.getElementById('resp1').value = data['resp1'];
                    if(data['spec2']) document.getElementById('spec2').value = data['spec2'];
                    if(data['resp2']) document.getElementById('resp2').value = data['resp2'];
                    if(document.getElementById('spec1')) checkSelectPlaceholder(document.getElementById('spec1'));
                    if(document.getElementById('spec2')) checkSelectPlaceholder(document.getElementById('spec2'));
                }
                updateDayCalculations(); alert("íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
            } catch (err) { alert("íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."); }
        };
        reader.readAsText(file); input.value = ''; 
    }

    function formatNumber(target, type) {
        let val = target.value.replace(/[^0-9]/g, ''); let result = val;
        if(type === 'money' && val) result = Number(val).toLocaleString();
        else if(type === 'phone' && val.length > 3) result = val.substr(0,3)+'-'+val.substr(3,4)+'-'+val.substr(7);
        else if(type === 'id') { if(val.length > 13) val = val.substr(0, 13); if(val.length > 6) result = val.substr(0,6) + '-' + val.substr(6); else result = val; }
        else if(type === 'biz' && val.length > 3) result = val.substr(0,3)+'-'+val.substr(3,2)+'-'+val.substr(5);
        target.value = result;
    }

    function formatCompPhone(target) {
        let val = target.value.replace(/[^0-9]/g, ''); if(val.length > 12) val = val.substr(0, 12); target.value = val;
    }

    function showTooltip(input) {
        if(input.disabled) return; 
        const tooltipId = 'tooltip_' + input.id; const tooltip = document.getElementById(tooltipId);
        if(tooltip) {
            const container = input.closest('.tooltip-container');
            if(container) { tooltip.style.display = 'block'; tooltip.style.top = '24px'; tooltip.style.left = '0px'; tooltip.classList.add('show'); }
        }
    }

    function hideTooltip(input) {
        const tooltipId = 'tooltip_' + input.id; const tooltip = document.getElementById(tooltipId);
        if(tooltip) { tooltip.classList.remove('show'); }
    }

    const jobData = { "ê¸°ê³„": ["ê³µì¡°ëƒ‰ë™ ë° ì„¤ë¹„", "ìš©ì ‘"] };

    function initAllFields() {
        const taskSelects = [document.getElementById('task1'), document.getElementById('task2')];
        const taskOptions = ["ìœ ì§€ê´€ë¦¬", "ìœ ì§€ë³´ìˆ˜ë°ë³´ê°•"];
        taskSelects.forEach(select => {
            if(select) {
                taskOptions.forEach(key => { let option = document.createElement("option"); option.value = key; option.text = key; select.appendChild(option); });
            }
        });
        updateSpecialty(1); updateSpecialty(2);
        const allSelects = document.querySelectorAll('select'); allSelects.forEach(el => checkSelectPlaceholder(el));
        checkEntry1();
    }

    function checkSelectPlaceholder(el) {
        if (!el.value) el.classList.add('empty-value'); else el.classList.remove('empty-value');
    }

    function updateSpecialty(idx) {
        const specSelect = document.getElementById('spec' + idx);
        const selectedJob = "ê¸°ê³„"; specSelect.innerHTML = '<option value="">ì„ íƒ</option>';
        if (selectedJob && jobData[selectedJob]) {
            jobData[selectedJob].forEach(spec => { let option = document.createElement("option"); option.value = spec; option.text = spec; specSelect.appendChild(option); });
        }
        checkSelectPlaceholder(specSelect); 
    }

    function updateResponsibility(idx) { return; }

    function toggleRetireDate() {
        const chk = document.getElementById('chk_working'); const dateInput = document.getElementById('retire_date'); const textDiv = document.getElementById('retire_text');
        if (chk.checked) { dateInput.style.display = 'none'; textDiv.style.display = 'block'; dateInput.value = ''; } 
        else { dateInput.style.display = 'block'; textDiv.style.display = 'none'; }
        validateAllDates(1); validateAllDates(2);
    }

    function calculateDays(startDateStr, endDateStr) {
        if(!startDateStr || !endDateStr) return 0;
        const start = new Date(startDateStr); const end = new Date(endDateStr);
        if (start > end) return 0;
        const diffTime = Math.abs(end - start);
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1; 
    }

    function updateDayCalculations() {
        const s1 = document.getElementById('part_start_1').value; const e1 = document.getElementById('part_end_1').value;
        const days1 = calculateDays(s1, e1); document.getElementById('panel_days_1').innerText = days1;
        const s2 = document.getElementById('part_start_2').value; const e2 = document.getElementById('part_end_2').value;
        const days2 = calculateDays(s2, e2); document.getElementById('panel_days_2').innerText = days2;
    }

    function validateAllDates(idx) {
        const joinDateEl = document.getElementById('join_date'); const retireDateEl = document.getElementById('retire_date');
        const isWorking = document.getElementById('chk_working').checked;

        if(!joinDateEl.value) joinDateEl.classList.add('required-missing'); else joinDateEl.classList.remove('required-missing');
        if(!isWorking && !retireDateEl.value) retireDateEl.classList.add('required-missing'); else retireDateEl.classList.remove('required-missing');

        const joinDate = joinDateEl.value; const retireDate = retireDateEl.value;
        if (!isWorking && joinDate && retireDate && joinDate > retireDate) {
            alert("ì…ì‚¬ì¼/í‡´ì‚¬ì¼: í‡´ì‚¬ì¼ì´ ì…ì‚¬ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); document.getElementById('retire_date').value = ""; return;
        }

        const partStartEl = document.getElementById('part_start_' + idx); const partEndEl = document.getElementById('part_end_' + idx);
        if (!partStartEl || !partEndEl) return;

        const partStart = partStartEl.value; const partEnd = partEndEl.value;
        if (partStart && partEnd && partStart > partEnd) {
            alert("ì°¸ì—¬ê¸°ê°„: ì¢…ë£Œì¼ì´ ì‹œì‘ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); partEndEl.value = ""; updateDayCalculations(); return;
        }
        if (partStart && joinDate && partStart < joinDate) {
             alert(`ì°¸ì—¬ê¸°ê°„ ì‹œì‘ì¼(${partStart})ì€ ì…ì‚¬ì¼(${joinDate})ë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`); partStartEl.value = ""; return;
        }
        if (partEnd) {
            if (!isWorking && retireDate && partEnd > retireDate) {
                alert(`ì°¸ì—¬ê¸°ê°„ ì¢…ë£Œì¼(${partEnd})ì€ í‡´ì‚¬ì¼(${retireDate})ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`); partEndEl.value = ""; return;
            }
        }
        checkOverlap(); updateDayCalculations();
    }

    function checkOverlap() {
        const s1 = document.getElementById('part_start_1').value; const e1 = document.getElementById('part_end_1').value;
        const s2 = document.getElementById('part_start_2').value; const e2 = document.getElementById('part_end_2').value;
        if (s1 && e1 && s2 && e2) {
            if (s1 <= e2 && e1 >= s2) {
                alert("ì˜¤ë¥˜: ì—°ë²ˆ1ê³¼ ì—°ë²ˆ2ì˜ ì°¸ì—¬ê¸°ê°„ì€ ê²¹ì¹  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në‚ ì§œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.");
                document.getElementById('part_start_2').value = ""; document.getElementById('part_end_2').value = "";
                updateDayCalculations(); 
            }
        }
    }

    function checkHeadquarters(idx) {
        const pName = document.getElementById('proj_name_' + idx); const spec = document.getElementById('spec' + idx);
        if (!pName || !spec) return;
        if (pName.value.trim() === 'ë³¸ì‚¬') {
            spec.innerHTML = '<option value=""></option>'; spec.disabled = true; checkSelectPlaceholder(spec); 
        } else {
            if (!pName.disabled) { 
                spec.disabled = false;
                if (spec.options.length === 1 && spec.options[0].text === "") updateSpecialty(idx);
            }
        }
    }

    function checkEntry2() {
        const requiredFields2 = document.querySelectorAll('.e2-req');
        requiredFields2.forEach(el => {
            if (!el.disabled) { 
                if (!el.value.trim()) el.classList.add('required-missing'); else el.classList.remove('required-missing'); 
            } else { el.classList.remove('required-missing'); }
        });
    }

    function checkEntry1() {
        const requiredFields1 = document.querySelectorAll('.e1-req');
        let allFilled = true; let isCompletelyEmpty = true; 
        requiredFields1.forEach(el => {
            if (el.value.trim()) { isCompletelyEmpty = false; el.classList.remove('required-missing'); }
            else { allFilled = false; el.classList.add('required-missing'); }
        });

        const entry2Rows = document.querySelectorAll('.entry2-row');
        const entry2Inputs = document.querySelectorAll('.e2-all');
        const alertMsg = "ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";

        if (allFilled) {
            entry2Inputs.forEach(el => el.disabled = false);
            entry2Rows.forEach(row => row.removeAttribute('title')); 
            const tooltip2 = document.getElementById('tooltip_proj_name_2');
            if(tooltip2) tooltip2.style.display = 'block';
            checkHeadquarters(2); checkEntry2();
        } else {
            entry2Inputs.forEach(el => {
                el.disabled = true; el.value = ""; el.classList.remove('required-missing'); 
                if(el.tagName === 'SELECT') checkSelectPlaceholder(el);
            });
            entry2Rows.forEach(row => row.setAttribute('title', alertMsg)); 
            const tooltip2 = document.getElementById('tooltip_proj_name_2');
            if(tooltip2) tooltip2.style.display = 'none';
            updateDayCalculations();
        }
        return { allFilled, isCompletelyEmpty };
    }

    function validateAndPrint() {
        // [ëª¨ë°”ì¼ í™˜ê²½ ì²´í¬]
        const isMobile = window.innerWidth <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        if (isMobile) {
            alert("PCì—ì„œ ì¶œë ¥í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.");
            return; 
        }

        const status1 = checkEntry1();
        if (status1.isCompletelyEmpty) { window.print(); return; }
        if (!status1.allFilled) {
            alert("ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        const entry2InputsAll = document.querySelectorAll('.e2-all');
        let isEntry2Started = false;
        entry2InputsAll.forEach(el => { if (el.value.trim()) isEntry2Started = true; });

        if (isEntry2Started) {
            const requiredFields2 = document.querySelectorAll('.e2-req');
            let allFilled2 = true;
            requiredFields2.forEach(el => {
                if (!el.value.trim()) { allFilled2 = false; el.classList.add('required-missing'); }
                else { el.classList.remove('required-missing'); }
            });
            if (!allFilled2) {
                alert("ì—°ë²ˆ2ë¥¼ ì‘ì„± ì¤‘ì…ë‹ˆë‹¤. ì—°ë²ˆ2ì˜ í•„ìˆ˜ê°’ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ì…ë ¥í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì—°ë²ˆ2 ë‚´ìš©ì„ ëª¨ë‘ ì§€ì›Œì£¼ì„¸ìš”)");
                return;
            }
        }
        window.print();
    }
</script>

</body>
</html>
