<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì ê²½ë ¥í™•ì¸ì„œ</title>
<style>
    /* 1. ë¬¸ì„œ ê¸°ë³¸ ì„¤ì • */
    body { background-color: #555; padding: 30px; font-family: 'Malgun Gothic', 'Dotum', sans-serif; display: flex; justify-content: center; }
    
    .page-container {
        background-color: white; 
        width: 210mm; 
        min-height: 297mm; 
        padding: 10mm 15mm; 
        box-shadow: 0 0 15px rgba(0,0,0,0.5);
        box-sizing: border-box; 
        position: relative;
        display: flex;
        flex-direction: column;
    }

    /* 2. í…Œì´ë¸” ê³µí†µ ìŠ¤íƒ€ì¼ */
    table { width: 100%; border-collapse: collapse; margin: 0; table-layout: fixed; }
    
    th, td { 
        border: 1px solid #000; 
        padding: 1px 3px; 
        vertical-align: middle; 
        word-break: keep-all; 
        font-size: 8.5pt;
        height: 24px;
        color: #000;
    }
    
    .no-side-outer tr th:first-child, .no-side-outer tr td:first-child { border-left: none !important; }
    .no-side-outer tr th:last-child, .no-side-outer tr td:last-child { border-right: none !important; }
    
    th { background-color: #e6e6e6; text-align: center; font-weight: normal; letter-spacing: -0.5px; }
    
    .border-top-thick { border-top: 2px solid #000 !important; }
    .border-bottom-thick { border-bottom: 2px solid #000 !important; }
    
    /* 3. ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
    input, textarea, select {
        width: 100%; height: 100%; border: none; padding: 0; margin: 0;
        font-family: inherit; font-size: 8.5pt;
        background-color: transparent; outline: none; box-sizing: border-box;
        vertical-align: middle;
        color: #000;
        transition: letter-spacing 0.1s ease;
    }
    select {
        word-break: keep-all;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    input:focus, textarea:focus, select:focus { background-color: #e8f0fe; }
    
    .empty-value { color: #999 !important; }
    ::placeholder { 
        color: #999; 
        font-size: 8pt; 
        text-align: center; 
        opacity: 0.7;
    }

    input:disabled, select:disabled {
        background-color: #f0f0f0;
        color: #aaa;
        cursor: not-allowed;
    }
    input[type="date"]:disabled {
        background-color: transparent;
    }

    .center-text { text-align: center; }
    .left-text { text-align: left !important; padding-left: 5px; }

    input[type="date"] {
        font-family: 'Malgun Gothic', sans-serif;
        letter-spacing: -0.5px;
        text-align: center;
        font-size: 8pt;
        color: transparent; 
        padding: 0;
    }
    input[type="date"]:focus,
    input[type="date"]:valid {
        color: #000; 
    }
    input[type="date"]::-webkit-datetime-edit { color: transparent; }
    input[type="date"]:focus::-webkit-datetime-edit,
    input[type="date"]:valid::-webkit-datetime-edit { color: #000; }

    input[type="date"]::-webkit-calendar-picker-indicator { 
        cursor: pointer; 
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555555'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E");
        background-position: center;
        background-repeat: no-repeat;
        background-size: contain;
        width: 14px;
        height: 14px;
        opacity: 0.7;
        margin-left: 2px;
        filter: none; 
        color: transparent;
    }
    input[type="date"]::-webkit-calendar-picker-indicator:hover {
        opacity: 1;
        transform: scale(1.1);
    }
    input[type="date"]:disabled::-webkit-calendar-picker-indicator {
        cursor: not-allowed;
        opacity: 0.3;
        display: block !important;
        visibility: visible !important;
        -webkit-appearance: menulist-button !important;
        appearance: menulist-button !important;
    }

    .long-label { font-size: 7pt; letter-spacing: -0.8px; line-height: 1.1; }
    .nowrap-text { white-space: nowrap; }

    /* â˜…â˜…â˜… [ìˆ˜ì •ë¨] ì»¤ìŠ¤í…€ íˆ´íŒ ìŠ¤íƒ€ì¼: ì• ë‹ˆë©”ì´ì…˜ ì œê±° â˜…â˜…â˜… */
    .custom-tooltip {
        position: absolute;
        z-index: 1000;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        
        /* ë°•ìŠ¤ í¬ê¸° ë° í°íŠ¸ */
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 8pt;
        white-space: nowrap;
        font-weight: bold;
        
        /* 1. ë‚´ë¶€ ë°°ê²½ìƒ‰ (ì–´ë‘ìš´ íšŒìƒ‰) */
        background-color: #222; 
        color: white;

        /* 2. ê·¸ë¼ë°ì´ì…˜ í…Œë‘ë¦¬ ë§ˆë²• */
        border: 2px solid transparent; /* íˆ¬ëª… í…Œë‘ë¦¬ ê³µê°„ í™•ë³´ */
        background-image: linear-gradient(#222, #222), /* ì•ˆìª½ ë°°ê²½ */
                          linear-gradient(135deg, #ff00cc, #3333ff, #00ccff); /* í…Œë‘ë¦¬ ê·¸ë¼ë°ì´ì…˜ */
        background-origin: border-box;
        background-clip: padding-box, border-box; /* ì•ˆìª½ì€ paddingê¹Œì§€, í…Œë‘ë¦¬ëŠ” borderê¹Œì§€ */
        
        /* 3. ì´ˆê¸° ê·¸ë¦¼ì (ê¸€ë¡œìš°) - ì •ì ì¸ ìƒíƒœë¡œ ìœ ì§€ */
        box-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
    }

    .custom-tooltip.show {
        opacity: 1;
    }
    .tooltip-container {
        position: relative;
    }

    /* 4. ë²„íŠ¼ë°” ìŠ¤íƒ€ì¼ */
    .btn-bar { 
        position: fixed; top: 20px; right: 20px; z-index: 999; display: flex; gap: 10px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
    }

    /* ì°¸ì—¬ê¸°ê°„ ê³„ì‚°ê¸° íŒ¨ë„ */
    .calc-panel {
        position: fixed; 
        top: 450px; 
        left: 20px; 
        z-index: 999;
        display: flex; flex-direction: column; gap: 10px;
        padding: 15px 20px;
        width: 160px;
        background: rgba(255, 140, 0, 0.65); 
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 16px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px 0 rgba(230, 81, 0, 0.3);
        color: white;
        font-family: 'Malgun Gothic', sans-serif;
    }
    .calc-header {
        font-weight: bold; font-size: 11pt; border-bottom: 1px solid rgba(255,255,255,0.5); padding-bottom: 8px; margin-bottom: 5px; text-align: center; text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    .calc-row { display: flex; justify-content: space-between; align-items: center; }
    .calc-label { font-size: 10pt; color: #fff; font-weight: 500; }
    .calc-val-box { text-align: right; }
    .calc-value { font-weight: bold; font-size: 16pt; color: #fff; text-shadow: 0 1px 3px rgba(0,0,0,0.3); }
    .calc-unit { font-size: 10pt; margin-left: 2px; color: #ffe0b2; }

    button { 
        padding: 12px 18px; font-size: 13px; cursor: pointer; 
        border: 1px solid rgba(255, 255, 255, 0.3); 
        border-radius: 12px; font-weight: bold; color: white; 
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        transition: all 0.3s ease;
    }
    button:hover { 
        background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.4); transform: translateY(-2px); box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.5);
    }
    button:active { transform: translateY(0); box-shadow: 0 4px 20px 0 rgba(31, 38, 135, 0.3); }
    
    .btn-blue { background: rgba(41, 128, 185, 0.3); border: 1px solid rgba(41, 128, 185, 0.5); }
    .btn-blue:hover { background: rgba(41, 128, 185, 0.4); border: 1px solid rgba(41, 128, 185, 0.6); }
    
    .btn-green { background: rgba(39, 174, 96, 0.3); border: 1px solid rgba(39, 174, 96, 0.5); }
    .btn-green:hover { background: rgba(39, 174, 96, 0.4); border: 1px solid rgba(39, 174, 96, 0.6); }
    
    .btn-dark { background: rgba(51, 51, 51, 0.3); border: 1px solid rgba(51, 51, 51, 0.5); }
    .btn-dark:hover { background: rgba(51, 51, 51, 0.4); border: 1px solid rgba(51, 51, 51, 0.6); }
    
    .btn-pink { background: rgba(255, 105, 180, 0.35); border: 1px solid rgba(255, 105, 180, 0.5); }
    .btn-pink:hover { background: rgba(255, 105, 180, 0.45); border: 1px solid rgba(255, 105, 180, 0.6); }

    .btn-red { background: rgba(192, 57, 43, 0.3); border: 1px solid rgba(192, 57, 43, 0.5); }
    .btn-red:hover { background: rgba(192, 57, 43, 0.4); border: 1px solid rgba(192, 57, 43, 0.6); }

    .footer-wrapper { margin-top: auto; display: flex; flex-direction: column; justify-content: flex-end; }
    .working-check-label { font-size: 8pt; display: flex; align-items: center; cursor: pointer; background: #f8f9fa; padding: 0 4px; border-radius: 4px; border: 1px solid #ddd; height: 20px; margin-left: 2px; }
    .working-check-label input { width: 12px; height: 12px; margin-right: 3px; cursor: pointer; }
    .required-missing { border: 2px solid #ff3333 !important; background-color: rgba(255, 51, 51, 0.05) !important; border-radius: 3px; box-shadow: 0 0 3px rgba(255, 0, 0, 0.3); }

    /* 5. ì¸ì‡„ ëª¨ë“œ ì„¤ì • */
    @media print {
        @page { size: A4; margin: 10mm 15mm 0mm 15mm; }
        body { background: white; padding: 0; margin: 0; height: 100%; }
        /* ì¸ì‡„ ì‹œ íˆ´íŒ ìˆ¨ê¸°ê¸° ì¶”ê°€ */
        .btn-bar, .calc-panel, .custom-tooltip { display: none !important; }

        .page-container { 
            margin: 0; box-shadow: none; width: 100%; padding: 0; 
            display: flex; flex-direction: column;
            height: 285mm; min-height: 285mm; border: none;
        }

        .footer-wrapper { margin-top: auto !important; flex-grow: 1; justify-content: flex-end !important; padding-bottom: 0; }

        input, textarea, select { background: transparent !important; appearance: none; -webkit-appearance: none; }
        select { padding-right: 0; text-indent: 0.1px; text-overflow: ''; }
        ::placeholder { color: transparent !important; }
        .empty-value { color: transparent !important; }
        input[type="date"] { color: transparent; }
        input[type="date"]:valid { color: #000; }
        input[type="date"]::-webkit-datetime-edit { color: transparent; }
        input[type="date"]:valid::-webkit-datetime-edit { color: #000; }
        input:disabled, select:disabled { background-color: transparent !important; color: #000; }
        .required-missing { background-color: transparent !important; border: none !important; box-shadow: none !important; }
        input[type="date"]::-webkit-calendar-picker-indicator { display: none !important; -webkit-appearance: none; }
        .working-check-label { display: none !important; }
    }
</style>
</head>
<body onload="initAllFields()">

<input type="file" id="file_input" style="display:none" accept=".json" onchange="loadFromFile(this)">

<div class="calc-panel">
    <div class="calc-header">ğŸ“… ì°¸ì—¬ê¸°ê°„ ê³„ì‚°ê¸°</div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 1</span>
        <div class="calc-val-box"><span id="panel_days_1" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 2</span>
        <div class="calc-val-box"><span id="panel_days_2" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
</div>

<div class="btn-bar">
    <button class="btn-blue" onclick="saveToFile()">ğŸ’¾ íŒŒì¼ ì €ì¥</button>
    <button class="btn-green" onclick="triggerFileLoad()">ğŸ“‚ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</button>
    <button class="btn-pink" onclick="validateAndPrint()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
    <button class="btn-red" onclick="if(confirm('ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) location.reload();">ğŸ”„ ì´ˆê¸°í™”</button>
</div>

<div class="page-container">
    <div style="font-size: 8pt; margin-bottom: 15px; font-weight:bold;">
        â–  ê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ [ë³„ì§€ ì œ12í˜¸ì„œì‹] &lt;ê°œì • 2024. 4. 23.&gt;
    </div>

    <div style="position: relative; height: 60px; margin-bottom: 20px;">
        <h1 style="position: absolute; width: 100%; top: 60%; transform: translateY(-50%); text-align: center; font-size: 20pt; letter-spacing: 5px; margin: 0; padding-right: 150px; box-sizing: border-box;">
            ê²½ë ¥í™•ì¸ì„œ
        </h1>
        
        <table style="width: 180px; position: absolute; top: -20px; right: 0; border: 2px solid black; height: 40px;">
            <colgroup><col style="width: 40%"><col style="width: 40%"><col style="width: 40%"></colgroup>
            <tr>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">êµ¬ë¶„</th>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì¸ì‚¬ë¶€ì„œ</th>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì‚¬ì—…ë¶€ì„œ</th>
            </tr>
            <tr>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë¶€ì„œëª…</th>
                <td style="height:7px;"></td> <td style="height:7px;"></td>
            </tr>
            <tr>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë‹´ë‹¹ì</th>
                <td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td>
                <td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td>
            </tr>
            <tr>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì—°ë½ì²˜</th>
                <td style="height:7px;"></td> <td style="height:7px;"></td>
            </tr>
            <tr>
                <th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë°œê¸‰ë²ˆí˜¸</th>
                <td colspan="2" style="height:7px;"></td>
            </tr>
        </table>
    </div>

    <table class="border-top-thick no-side-outer" style="margin-bottom: 10px;">
        <colgroup>
            <col style="width: 10%;"> 
            <col style="width: 10%;"> <col style="width: 20%;"> 
            <col style="width: 12%;"> <col style="width: 18%;"> 
            <col style="width: 13%;"> <col style="width: 17%;">
        </colgroup>
        <tr>
            <th rowspan="2">ì¸ì <br>ì‚¬í•­</th>
            <th>â‘  ì„± ëª…</th>
            <td>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <input type="text" id="user_name" style="width:60%;">
                    <span class="nowrap-text" style="font-size:7pt; color:#888;">(ì„œëª… ë˜ëŠ” ì¸)</span>
                </div>
            </td>
            <th>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th>
            <td><input type="text" id="user_id" class="center-text" oninput="formatNumber(this, 'id')"></td>
            <th class="long-label">íœ´ëŒ€ì „í™”ë²ˆí˜¸<br>(ì „í™”ë²ˆí˜¸)</th>
            <td><input type="text" id="user_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td>
        </tr>
        <tr>
            <th>â‘¡ ì£¼ ì†Œ</th>
            <td colspan="3"><input type="text" id="user_addr" oninput="autoFitText(this)"></td>
            <th>ì „ììš°í¸ì£¼ì†Œ</th>
            <td><input type="text" id="user_email"></td>
        </tr>
    </table>
    
    <table class="no-side-outer">
        <colgroup>
            <col style="width: 10%;"> 
            <col style="width: 10%;"> <col style="width: 20%;"> 
            <col style="width: 12%;"> <col style="width: 18%;"> 
            <col style="width: 13%;"> <col style="width: 17%;">
        </colgroup>
        <tr class="border-top-thick">
            <th rowspan="3">ì†Œì†<br>íšŒì‚¬</th>
            <th colspan="2">â‘¢ íšŒì‚¬ëª… ë° ëŒ€í‘œì</th>
            <td colspan="2"><input type="text" id="comp_name" oninput="autoFitText(this)"></td>
            <th class="long-label" style="font-size:7pt;">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸<br>(ë²•ì¸ë“±ë¡ë²ˆí˜¸)</th>
            <td><input type="text" id="comp_biz" class="center-text" oninput="formatNumber(this, 'biz')"></td>
        </tr>
        <tr>
            <th colspan="2">ì˜ì—…ì†Œ ì†Œì¬ì§€</th>
            <td colspan="2"><input type="text" id="comp_addr" oninput="autoFitText(this)"></td>
            <th class="long-label">â‘£ ê±´ì„¤ì—…ì¢…<br>(ë“±ë¡ë²ˆí˜¸)</th>
            <td><input type="text" id="comp_sector"></td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border-right:1px solid #000;">
                <div style="display:flex; height:100%; width:100%;">
                    <div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¤ ì…ì‚¬ì¼</div>
                    <div style="flex:1; border-right:1px solid #000; padding:0 2px;"><input type="date" id="join_date" required onchange="validateAllDates(1); validateAllDates(2);"></div>
                    <div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¥ í‡´ì‚¬ì¼</div>
                    <div style="flex:1; padding:0 2px; display:flex; align-items:center; justify-content:center;">
                        <input type="date" id="retire_date" required style="width: 100%;" onchange="validateAllDates(1); validateAllDates(2);">
                        <div id="retire_text" style="display:none; width:100%; text-align:center; font-size:8.5pt;">ì¬ì§ì¤‘</div>
                        <label class="working-check-label" title="í˜„ì¬ ê·¼ë¬´ ì¤‘ì´ë©´ ì²´í¬í•˜ì„¸ìš”">
                            <input type="checkbox" id="chk_working" onchange="toggleRetireDate()">ì¬ì§
                        </label>
                    </div>
                </div>
            </td>
            <th>ì „í™”ë²ˆí˜¸</th>
            <td><input type="text" id="comp_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td>
        </tr>
    </table>

    <div style="text-align:center; font-weight:bold; background:#eaeaea; border:1px solid #000; border-bottom:none; border-left:none; border-right:none; margin-top:5px; height:24px; line-height:24px; font-size:9pt;" class="border-top-thick">
        ê¸° ìˆ  ê²½ ë ¥
    </div>

    <table class="border-bottom-thick no-side-outer">
        <colgroup>
            <col style="width: 4%;"> 
            <col style="width: 24%;"> 
            <col style="width: 24%;"> 
            <col style="width: 24%;"> 
            <col style="width: 24%;">
        </colgroup>
        
        <tr>
            <th rowspan="5" class="border-bottom-thick">ì—°<br>ë²ˆ</th>
            <th class="left-text">â‘¦ ì‚¬ì—…ê¸°ê°„(ì°©ê³µ~ì¤€ê³µ)</th>
            <th colspan="3" class="left-text">â‘¨ ì°¸ì—¬ì‚¬ì—…ëª…</th>
        </tr>
        <tr>
            <th class="left-text">â‘§ ì°¸ì—¬ê¸°ê°„(ì‹œì‘~ì¢…ë£Œ)</th>
            <th colspan="3" class="left-text">â‘© ë°œì£¼ì(ì²­)</th>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup>
                        <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;">
                    </colgroup>
                    <tr>
                        <th class="left-text" style="border-left:none; border-top:none;">â‘ª ê³µì‚¬ì¢…ë¥˜</th>
                        <th class="left-text" style="border-top:none;">â‘« ê³µì‚¬(ìš©ì—­)ê¸ˆì•¡(ë°±ë§Œì›)</th>
                        <th class="left-text" style="border-top:none;">â‘¬ ì§ë¬´ë¶„ì•¼</th>
                        <th class="left-text" style="border-top:none; border-right:none;">â‘­ ì „ë¬¸ë¶„ì•¼</th>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;"style="width:100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #ccc;">        
                    <colgroup>
                        <col style="width:50%;"> <col style="width:18%;"> <col style="width:7%;"> <col style="width:25%;">
                    </colgroup>
                    <tr>
                        <th class="left-text" style="border-left:none; border-top:none;">â‘® ê³µì‚¬(ìš©ì—­)ê°œìš”(150ì ì´ë‚´ ë¹ˆì¹¸ í¬í•¨)</th>
                        <th class="left-text" style="border-top:none;">â‘¯ ë‹´ë‹¹ì—…ë¬´</th>
                        <th class="left-text" style="border-top:none; font-size: 6.5pt; letter-spacing: -0.5px; padding: 0; line-height: 24px; text-align:center; white-space:nowrap;">â‘° ì±…ì„ì •ë„</th>
                        <th class="left-text" style="border-top:none; border-right:none;">â‘± ì§ìœ„</th>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup>
                        <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;"> <col style="width:25%;">
                    </colgroup>
                    <tr>
                        <th class="left-text" style="border-left:none; border-top:none; border-bottom:1px solid black;">â‘² ì ìš© ê³µë²•</th>
                        <th class="left-text" style="border-top:none; border-bottom:1px solid black;">â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ </th>
                        <th class="left-text" style="border-top:none; border-bottom:1px solid black;">ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±</th>
                        <th class="left-text" style="border-top:none; border-bottom:1px solid black; border-right:none;">ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜</th>
                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <th rowspan="5" class="border-bottom-thick" style="background:#fff;">1</th>
            <td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td>
            <td colspan="3" class="tooltip-container">
                <input type="text" id="proj_name_1" class="left-text e1-req" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkEntry1(); checkHeadquarters(1)">
                <div class="custom-tooltip" id="tooltip_proj_name_1">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div>
            </td>
        </tr>
        <tr>
            <td><div style="display:flex;"><input type="date" id="part_start_1" required class="e1-req" style="width:48%;" onchange="validateAllDates(1)" oninput="checkEntry1()">~<input type="date" id="part_end_1" required class="e1-req" style="width:48%;" onchange="validateAllDates(1)" oninput="checkEntry1()"></div></td>
            <td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled></td>
                        <td style="border-top:none;"><input type="text" class="left-text" id="amt_1" disabled></td>
                        <td style="border-top:none; text-align: center;">
                            ê¸°ê³„
                        </td>
                        <td style="border-top:none; border-right:none; padding-left: 0;">
                            <select id="spec1" class="left-text e1-req" onchange="checkSelectPlaceholder(this); checkEntry1();">
                                <option value="">ì„ íƒ</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled></td>
                        <td style="border-top:none;">
                            <select id="task1" class="left-text e1-req" style="font-size: 8pt;" onchange="updateResponsibility(1); checkEntry1(); checkSelectPlaceholder(this);">
                                <option value="">ì„ íƒ</option>
                            </select>
                        </td>
                        <td style="border-top:none; padding-right: 0;">
                            <input type="text" id="resp1" class="left-text" disabled>
                        </td>
                        <td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_1" class="left-text e1-req" oninput="checkEntry1()"></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled></td>
                        <td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled></td>
                        <td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled></td>
                        <td style="border-top:none; border-bottom:2px solid black; border-right:none;"><input type="text" class="left-text" disabled></td>
                    </tr>
                </table>
            </td>
        </tr>

        <tr class="entry2-row">
            <th rowspan="5" style="background:#fff;">2</th>
            <td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td>
            
            <td colspan="3" class="tooltip-container e2-all">
                <input type="text" id="proj_name_2" class="left-text e2-req e2-all" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkHeadquarters(2); checkEntry2();" disabled>
                <div class="custom-tooltip e2-all" id="tooltip_proj_name_2" style="display: none;">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div>
            </td>
        </tr>
        <tr class="entry2-row">
            <td><div style="display:flex;"><input type="date" id="part_start_2" class="e2-req e2-all" style="width:48%;" onchange="validateAllDates(2); checkEntry2();" disabled>~<input type="date" id="part_end_2" class="e2-req e2-all" style="width:48%;" onchange="validateAllDates(2); checkEntry2();" disabled></div></td>
            <td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td>
        </tr>
        <tr class="entry2-row">
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none; text-align: center;">
                            ê¸°ê³„
                        </td>
                        <td style="border-top:none; border-right:none; padding-left: 0;">
                            <select id="spec2" class="left-text e2-req e2-all" onchange="checkSelectPlaceholder(this); checkEntry1(); checkEntry2();" disabled>
                                <option value="">ì§ë¬´ë¶„ì•¼ ì„ íƒ í•„ìš”</option>
                            </select>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr class="entry2-row">
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none;">
                            <select id="task2" class="left-text e2-req e2-all" style="font-size: 8pt;" onchange="updateResponsibility(2); checkSelectPlaceholder(this); checkEntry2();" disabled>
                                <option value="">ì„ íƒ</option>
                            </select>
                        </td>
                        <td style="border-top:none; padding-right: 0;">
                            <input type="text" id="resp2" class="left-text e2-all" disabled>
                        </td>
                        <td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_2" class="left-text e2-req e2-all" oninput="checkEntry2()" disabled></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr class="entry2-row">
            <td colspan="4" style="padding:0; border:none;">
                <table style="width:100%; border:none;">
                    <colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup>
                    <tr>
                        <td style="border-left:none; border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none;"><input type="text" class="left-text e2-all" disabled></td>
                        <td style="border-top:none; border-right:none;"><input type="text" class="left-text e2-all" disabled></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <div class="footer-wrapper">
        <div style="margin-top: 10px; display:flex; justify-content:space-between; align-items:flex-end;">
            <span style="font-size: 10pt; margin-left:5px;">ìœ„ì™€ ê°™ì´ ê±´ì„¤ê¸°ìˆ ì¸ì˜ ê²½ë ¥ì„ í™•ì¸í•©ë‹ˆë‹¤.</span>
            <span style="font-size: 10pt; margin-right:5px;">
                <input type="text" style="width:40px; text-align:right;">ë…„
                <input type="text" style="width:30px; text-align:right;">ì›”
                <input type="text" style="width:30px; text-align:right;">ì¼
            </span>
        </div>
        
        <div style="position:relative; width:100%; height:50px; text-align:center; margin-top:20px;">
            <span style="font-size: 16pt; font-weight: bold; letter-spacing: -1px;">
                ë°œì£¼ì, ì¸ã†í—ˆê°€ê¸°ê´€ ë˜ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì)
            </span>
            <div style="position:absolute; right:80px; top:-10px; width:50px; height:50px; display:flex; align-items:center; justify-content:center; color:red; font-weight:bold; border:2px solid red; font-size:10pt;">
                ì§ì¸
            </div>
        </div>

        <div style="margin-top: 5px;">        
            <table style="border: 1px solid #000; border-top: 2px solid #000; width:100%; border-bottom: none;">
                <tr>
                    <th style="background-color:#ccc; height:20px; border-bottom:3px solid #000; font-size:9pt; border-left:none; border-right:none;">ìœ ì˜ì‚¬í•­</th>
                </tr>
                <tr>
                    <td style="padding:10px 10px; font-size:8pt; line-height:1.6; border:none; vertical-align:top; letter-spacing:-0.5px;">
                        1. ê¸°ìˆ ê²½ë ¥ì„ ì„¤ê³„ ë˜ëŠ” ê±´ì„¤ì‚¬ì—…ê´€ë¦¬ ì‚¬ì—…ìˆ˜í–‰ëŠ¥ë ¥í‰ê°€ì— í™œìš©í•˜ë ¤ëŠ” ê²½ìš° ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•˜ë©°, ì…ì‚¬ì‹ ê³  ë˜ëŠ” ì¼ë°˜ì ì¸ ê²½ë ¥ì‹ ê³ ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì) ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>
                        2. â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ ë€, ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±ë€ ë° ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜ë€ì€ ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ì˜ í™•ì¸ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¸ì •ë©ë‹ˆë‹¤.<br>
                        3. ê±´ì„¤ê¸°ìˆ ì¸ ë³¸ì¸ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ê±´ì„¤ê¸°ìˆ ì¸ ê²½ë ¥ë³€ê²½ì‹ ê³ ì„œ(ã€Œê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ã€ ë³„ì§€ ì œ14í˜¸ì„œì‹ì„ ë§í•©ë‹ˆë‹¤)ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë˜ë©°, ì…ã†í‡´ì‚¬ì¼ì„ ì‹ ê³ í•˜ëŠ” ê²½ìš° 4ëŒ€ ë³´í—˜ ìë£Œ ë“± ì¦ëª…í•  ìˆ˜ ìˆëŠ” ì„œë¥˜ë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>
                        4. ë‹¤ìˆ˜ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ê¸°ìˆ ê²½ë ¥ë§Œì„ ì ì€ ì„œë¥˜ë¥¼ ì²¨ë¶€í•˜ì—¬ ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 2ì¥ ì´ìƒì€ ê° ì¥ì— ì‚¬ìš©ì(ëŒ€í‘œì) ë˜ëŠ” ë°œì£¼ìì˜ í™•ì¸(ê°„ì¸ í¬í•¨)ì„ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.<br>
                        5. ì‹ ê³ ì¸(ë³¸ì¸)ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì€ ë³¸ì¸ì´ ì§ì ‘ í•´ì•¼ í•˜ë©° íƒ€ì¸ì´ ì´ë¥¼ ìœ„ì¡°í•˜ëŠ” ê²½ìš° ã€Œí˜•ë²•ã€ ì œ239ì¡°ì— ë”°ë¼ ì²˜ë²Œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                        6. ëŒ€ë¦¬ì¸ì´ ì‹ ê³ í•˜ëŠ” ê²½ìš° ì‹¤ëª…í™•ì¸ì„ ìœ„í•´ ì•„ë˜ì˜ ê¸°ì¬ì‚¬í•­ì„ ì ì–´ì•¼ í•©ë‹ˆë‹¤.
                    </td>
                </tr>
            </table>
            
            <table style="border: 1px solid #000; border-top: 1px solid #000; border-bottom:2px solid #000; margin-top:-1px;">
                <colgroup>
                    <col style="width: 10%;"> <col style="width: 12%;"> <col style="width: 25%;"> 
                    <col style="width: 13%;"> <col style="width: 40%;">
                </colgroup>
                <tr>
                    <th style="background:#fff; height:24px; border-left:none;">ëŒ€ë¦¬ì¸</th>
                    <th style="background:#fff;">ì„±ëª…</th>
                    <td style="position:relative;">
                        <input type="text" class="center-text">
                        <span style="position:absolute; right:5px; top:5px; color:#aaa; font-size:6pt;">(ì„œëª… ë˜ëŠ” ì¸)</span>
                    </td>
                    <th style="background:#fff;">ìƒë…„ì›”ì¼</th>
                    <td style="border-right:none; padding:0;">
                        <div style="display:flex; height:100%;">
                            <input type="text" style="width:60%; text-align:center;">
                            <span style="border-left:1px solid #000; border-right:1px solid #000; width:100px; background:#fff; display:flex; align-items:center; justify-content:center; font-size:8pt;">ì—°ë½ì²˜</span>
                            <input type="text" style="flex-grow:1; text-align:center;">
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        
        <div style="text-align:right; font-size:8pt; margin-top:3px;">
        </div>
    </div>
</div>

<script>
    // â˜… í…ìŠ¤íŠ¸ ìê°„ ìë™ ì¡°ì ˆ í•¨ìˆ˜
    function autoFitText(el) {
        el.style.letterSpacing = 'normal';
        let hiddenSpan = document.getElementById('text-measure-span');
        if (!hiddenSpan) {
            hiddenSpan = document.createElement('span');
            hiddenSpan.id = 'text-measure-span';
            hiddenSpan.style.visibility = 'hidden';
            hiddenSpan.style.position = 'absolute';
            hiddenSpan.style.whiteSpace = 'nowrap';
            document.body.appendChild(hiddenSpan);
        }
        const computed = window.getComputedStyle(el);
        hiddenSpan.style.font = computed.font;
        hiddenSpan.style.fontSize = computed.fontSize;
        hiddenSpan.style.fontFamily = computed.fontFamily;
        hiddenSpan.style.fontWeight = computed.fontWeight;
        hiddenSpan.innerText = el.value;

        const textWidth = hiddenSpan.getBoundingClientRect().width;
        const availableWidth = el.clientWidth; 

        if (textWidth > availableWidth) {
            const length = el.value.length;
            if (length > 1) {
                const overflow = textWidth - availableWidth;
                let spacing = -1 * (overflow / (length - 1)) - 0.5; 
                if (spacing < -3) spacing = -3; 
                el.style.letterSpacing = spacing + 'px';
            }
        } else {
            el.style.letterSpacing = 'normal';
        }
    }

    // â˜… íŒŒì¼ ì €ì¥
    async function saveToFile() {
        const data = {};
        document.querySelectorAll('input, select').forEach(el => {
            if (el.id) {
                if(el.type === 'checkbox') data[el.id] = el.checked;
                else data[el.id] = el.value;
            }
        });
        const jsonStr = JSON.stringify(data, null, 2);
        const fileName = 'ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì_ê²½ë ¥í™•ì¸ì„œ_ë°ì´í„°.json';

        if (window.showSaveFilePicker) {
            try {
                const handle = await window.showSaveFilePicker({
                    suggestedName: fileName,
                    types: [{
                        description: 'JSON Files',
                        accept: { 'application/json': ['.json'] },
                    }],
                });
                const writable = await handle.createWritable();
                await writable.write(jsonStr);
                await writable.close();
                alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            } catch (err) {
                if (err.name === 'AbortError') { return; }
                console.error('File Picker Error:', err);
            }
        }

        const blob = new Blob([jsonStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° íŠ¸ë¦¬ê±°
    function triggerFileLoad() { document.getElementById('file_input').click(); }

    // íŒŒì¼ ë¡œë“œ ë¡œì§
    function loadFromFile(input) {
        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                
                for (const [id, val] of Object.entries(data)) {
                    const el = document.getElementById(id);
                    if(el) {
                        if(el.type === 'checkbox') el.checked = val;
                        else {
                            el.value = val;
                            if(id === 'user_addr' || id === 'comp_name' || id === 'comp_addr') {
                                autoFitText(el);
                            }
                        }
                        if(el.tagName === 'SELECT') checkSelectPlaceholder(el);
                    }
                }
                if(document.getElementById('chk_working').checked) toggleRetireDate();

                updateSpecialty(1);
                updateSpecialty(2);
                
                const status = checkEntry1();
                if(status.allFilled) {
                    if(data['task1']) updateResponsibility(1);
                    if(data['task2']) updateResponsibility(2);

                    if(data['spec1']) document.getElementById('spec1').value = data['spec1'];
                    if(data['resp1']) document.getElementById('resp1').value = data['resp1'];
                    if(data['spec2']) document.getElementById('spec2').value = data['spec2'];
                    if(data['resp2']) document.getElementById('resp2').value = data['resp2'];

                    if(document.getElementById('spec1')) checkSelectPlaceholder(document.getElementById('spec1'));
                    if(document.getElementById('spec2')) checkSelectPlaceholder(document.getElementById('spec2'));
                }
                updateDayCalculations();
                alert("íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
            } catch (err) {
                alert("íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
        };
        reader.readAsText(file);
        input.value = ''; 
    }

    function formatNumber(target, type) {
        let val = target.value.replace(/[^0-9]/g, ''); 
        let result = val;
        if(type === 'money') { if(val) result = Number(val).toLocaleString(); }
        else if(type === 'phone' && val.length > 3) { result = val.substr(0,3)+'-'+val.substr(3,4)+'-'+val.substr(7); }
        else if(type === 'id') { 
            if(val.length > 13) val = val.substr(0, 13);
            if(val.length > 6) { result = val.substr(0,6) + '-' + val.substr(6); } else { result = val; }
        }
        else if(type === 'biz' && val.length > 3) { result = val.substr(0,3)+'-'+val.substr(3,2)+'-'+val.substr(5); }
        target.value = result;
    }

    function formatCompPhone(target) {
        let val = target.value.replace(/[^0-9]/g, ''); 
        if(val.length > 12) val = val.substr(0, 12); 
        target.value = val;
    }

    function showTooltip(input) {
        if(input.disabled) return; 
        const tooltipId = 'tooltip_' + input.id;
        const tooltip = document.getElementById(tooltipId);
        if(tooltip) {
            const container = input.closest('.tooltip-container');
            if(container) {
                tooltip.style.display = 'block';
                tooltip.style.top = '24px'; 
                tooltip.style.left = '0px';
                tooltip.classList.add('show');
            }
        }
    }

    function hideTooltip(input) {
        const tooltipId = 'tooltip_' + input.id;
        const tooltip = document.getElementById(tooltipId);
        if(tooltip) { tooltip.classList.remove('show'); }
    }

    const jobData = { "ê¸°ê³„": ["ê³µì¡°ëƒ‰ë™ ë° ì„¤ë¹„", "ìš©ì ‘"] };

    function initAllFields() {
        const taskSelects = [document.getElementById('task1'), document.getElementById('task2')];
        const taskOptions = ["ìœ ì§€ê´€ë¦¬", "ìœ ì§€ë³´ìˆ˜ë°ë³´ê°•"];
        taskSelects.forEach(select => {
            if(select) {
                taskOptions.forEach(key => {
                    let option = document.createElement("option");
                    option.value = key;
                    option.text = key;
                    select.appendChild(option);
                });
            }
        });
        updateSpecialty(1);
        updateSpecialty(2);
        
        const allSelects = document.querySelectorAll('select');
        allSelects.forEach(el => checkSelectPlaceholder(el));
        checkEntry1();
    }

    function checkSelectPlaceholder(el) {
        if (!el.value) { el.classList.add('empty-value'); } else { el.classList.remove('empty-value'); }
    }

    function updateSpecialty(idx) {
        const specSelect = document.getElementById('spec' + idx);
        const selectedJob = "ê¸°ê³„"; 
        specSelect.innerHTML = '<option value="">ì„ íƒ</option>';
        if (selectedJob && jobData[selectedJob]) {
            jobData[selectedJob].forEach(spec => {
                let option = document.createElement("option");
                option.value = spec;
                option.text = spec;
                specSelect.appendChild(option);
            });
        }
        checkSelectPlaceholder(specSelect); 
    }

    function updateResponsibility(idx) { return; }

    function toggleRetireDate() {
        const chk = document.getElementById('chk_working');
        const dateInput = document.getElementById('retire_date');
        const textDiv = document.getElementById('retire_text');
        if (chk.checked) {
            dateInput.style.display = 'none';
            textDiv.style.display = 'block';
            dateInput.value = ''; 
        } else {
            dateInput.style.display = 'block';
            textDiv.style.display = 'none';
        }
        validateAllDates(1);
        validateAllDates(2);
    }

    /* â˜… ì°¸ì—¬ê¸°ê°„ ì¼ìˆ˜ ê³„ì‚° í•¨ìˆ˜ */
    function calculateDays(startDateStr, endDateStr) {
        if(!startDateStr || !endDateStr) return 0;
        const start = new Date(startDateStr);
        const end = new Date(endDateStr);
        if (start > end) return 0;
        
        const diffTime = Math.abs(end - start);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1; 
        return diffDays;
    }

    /* â˜… ê³„ì‚°ê¸° íŒ¨ë„ ê°’ ì—…ë°ì´íŠ¸ */
    function updateDayCalculations() {
        const s1 = document.getElementById('part_start_1').value;
        const e1 = document.getElementById('part_end_1').value;
        const days1 = calculateDays(s1, e1);
        document.getElementById('panel_days_1').innerText = days1;

        const s2 = document.getElementById('part_start_2').value;
        const e2 = document.getElementById('part_end_2').value;
        const days2 = calculateDays(s2, e2);
        document.getElementById('panel_days_2').innerText = days2;
    }

    function validateAllDates(idx) {
        const joinDateEl = document.getElementById('join_date');
        const retireDateEl = document.getElementById('retire_date');
        const isWorking = document.getElementById('chk_working').checked;

        if(!joinDateEl.value) joinDateEl.classList.add('required-missing');
        else joinDateEl.classList.remove('required-missing');

        if(!isWorking && !retireDateEl.value) retireDateEl.classList.add('required-missing');
        else retireDateEl.classList.remove('required-missing');

        const joinDate = joinDateEl.value;
        const retireDate = retireDateEl.value;

        if (!isWorking && joinDate && retireDate && joinDate > retireDate) {
            alert("ì…ì‚¬ì¼/í‡´ì‚¬ì¼: í‡´ì‚¬ì¼ì´ ì…ì‚¬ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            document.getElementById('retire_date').value = "";
            return;
        }

        const partStartEl = document.getElementById('part_start_' + idx);
        const partEndEl = document.getElementById('part_end_' + idx);

        if (!partStartEl || !partEndEl) return;

        const partStart = partStartEl.value;
        const partEnd = partEndEl.value;

        if (partStart && partEnd && partStart > partEnd) {
            alert("ì°¸ì—¬ê¸°ê°„: ì¢…ë£Œì¼ì´ ì‹œì‘ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            partEndEl.value = "";
            updateDayCalculations(); 
            return;
        }

        if (partStart && joinDate && partStart < joinDate) {
             alert(`ì°¸ì—¬ê¸°ê°„ ì‹œì‘ì¼(${partStart})ì€ ì…ì‚¬ì¼(${joinDate})ë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
             partStartEl.value = "";
             return;
        }
        if (partEnd) {
            if (!isWorking && retireDate && partEnd > retireDate) {
                alert(`ì°¸ì—¬ê¸°ê°„ ì¢…ë£Œì¼(${partEnd})ì€ í‡´ì‚¬ì¼(${retireDate})ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                partEndEl.value = "";
                return;
            }
        }

        checkOverlap();
        updateDayCalculations();
    }

    function checkOverlap() {
        const s1 = document.getElementById('part_start_1').value;
        const e1 = document.getElementById('part_end_1').value;
        const s2 = document.getElementById('part_start_2').value;
        const e2 = document.getElementById('part_end_2').value;

        if (s1 && e1 && s2 && e2) {
            if (s1 <= e2 && e1 >= s2) {
                alert("ì˜¤ë¥˜: ì—°ë²ˆ1ê³¼ ì—°ë²ˆ2ì˜ ì°¸ì—¬ê¸°ê°„ì€ ê²¹ì¹  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në‚ ì§œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.");
                document.getElementById('part_start_2').value = "";
                document.getElementById('part_end_2').value = "";
                updateDayCalculations(); 
            }
        }
    }

    function checkHeadquarters(idx) {
        const pName = document.getElementById('proj_name_' + idx);
        const spec = document.getElementById('spec' + idx);
        if (!pName || !spec) return;
        
        if (pName.value.trim() === 'ë³¸ì‚¬') {
            spec.innerHTML = '<option value=""></option>';
            spec.disabled = true;
            checkSelectPlaceholder(spec); 
        } else {
            if (!pName.disabled) { 
                spec.disabled = false;
                if (spec.options.length === 1 && spec.options[0].text === "") {
                    updateSpecialty(idx);
                }
            }
        }
    }

    function checkEntry2() {
        const requiredFields2 = document.querySelectorAll('.e2-req');
        requiredFields2.forEach(el => {
            if (!el.disabled) { 
                if (!el.value.trim()) {
                    el.classList.add('required-missing'); 
                } else {
                    el.classList.remove('required-missing'); 
                }
            } else {
                el.classList.remove('required-missing'); 
            }
        });
    }

    function checkEntry1() {
        const requiredFields1 = document.querySelectorAll('.e1-req');
        let allFilled = true;
        let isCompletelyEmpty = true; 

        requiredFields1.forEach(el => {
            if (el.value.trim()) {
                isCompletelyEmpty = false;
                el.classList.remove('required-missing');
            } else {
                allFilled = false;
                el.classList.add('required-missing');
            }
        });

        const entry2Rows = document.querySelectorAll('.entry2-row');
        const entry2Inputs = document.querySelectorAll('.e2-all');
        const alertMsg = "ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";

        if (allFilled) {
            entry2Inputs.forEach(el => el.disabled = false);
            entry2Rows.forEach(row => row.removeAttribute('title')); 
            const tooltip2 = document.getElementById('tooltip_proj_name_2');
            if(tooltip2) tooltip2.style.display = 'block';
            checkHeadquarters(2); 
            checkEntry2();
        } else {
            entry2Inputs.forEach(el => {
                el.disabled = true;
                el.value = "";
                el.classList.remove('required-missing'); 
                if(el.tagName === 'SELECT') checkSelectPlaceholder(el);
            });
            entry2Rows.forEach(row => row.setAttribute('title', alertMsg)); 
            const tooltip2 = document.getElementById('tooltip_proj_name_2');
            if(tooltip2) tooltip2.style.display = 'none';
            updateDayCalculations();
        }
        return { allFilled, isCompletelyEmpty };
    }

    function validateAndPrint() {
        const status1 = checkEntry1();
        if (status1.isCompletelyEmpty) { window.print(); return; }
        if (!status1.allFilled) {
            alert("ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        const entry2InputsAll = document.querySelectorAll('.e2-all');
        let isEntry2Started = false;
        entry2InputsAll.forEach(el => { if (el.value.trim()) isEntry2Started = true; });

        if (isEntry2Started) {
            const requiredFields2 = document.querySelectorAll('.e2-req');
            let allFilled2 = true;
            requiredFields2.forEach(el => {
                if (!el.value.trim()) {
                    allFilled2 = false;
                    el.classList.add('required-missing'); 
                } else {
                    el.classList.remove('required-missing');
                }
            });
            if (!allFilled2) {
                alert("ì—°ë²ˆ2ë¥¼ ì‘ì„± ì¤‘ì…ë‹ˆë‹¤. ì—°ë²ˆ2ì˜ í•„ìˆ˜ê°’ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ì…ë ¥í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì—°ë²ˆ2 ë‚´ìš©ì„ ëª¨ë‘ ì§€ì›Œì£¼ì„¸ìš”)");
                return;
            }
        }
        window.print();
    }
</script>

</body>
</html>